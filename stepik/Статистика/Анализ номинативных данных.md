
Любую номинативную переменную мы можем закодировать при помощи чисел. Например, пол: 1 - мужчина, 0 - женщина. Тогда наши данные о десяти испытуемых могут быть записаны следующим образом:  1, 1, 1, 0, 0, 0, 0, 0, 0, 1

**Расстояние хи квадрат Пирсона**
Значения:
O - observed (наблюдаемый)
E - expected (ожидаемый)
![[Pasted image 20240217174939.png]]
![[Pasted image 20240217180345.png]]

![[Pasted image 20240217180629.png]]

**Распределение хи квадрат Пирсона**
![[Pasted image 20240217183339.png]]

![[Pasted image 20240217184102.png]]
![[Pasted image 20240217184924.png]]
R: 

```r
qchisq(0.95, 2)
```

5.991465

Давайте вспомним как рассчитывается значение статистики в тесте Стьюдента (на примере одновыборочного теста):
![[Pasted image 20240217185736.png]]
В знаменателе у нас находится стандартная ошибка, которая представляет собой выборочное стандартное отклонение, делённое на  корень из объёма выборки. В расчёт стандартного отклонения входит сумма квадратов отклонений наблюдаемых значений от их среднего значения - то есть сумма нескольких случайных положительных величин. А из предыдущих степов мы знаем, что сумма квадратов n случайных положительных величин может быть описана при помощи распределения хи-квадрат с n-1 степеням свободы! Так как зная выборочное среднее и n-1 элементов выборки мы всегда можем точно задать последний элемент! Получается, в знаменателе t-статистики у нас спрятано распределение хи-квадрат, для которого нам и нужно знать количество степеней свободы! Таким образом, степени свободы в T-распределении на самом деле берутся из распределения хи-квадрат, которое спрятано в формуле T-статистики.
Давайте теперь вспомним формулу F-статистики, которая является главным показателем дисперсионного анализа:
![[Pasted image 20240217185759.png]]
В числителе находится сумма квадратов отклонений групповых средних от общего среднего. В знаменателе у нас сумма квадратов отклонений наблюдений от внутригрупповых средних. Таким образом, у нас опять две величины, складывающиеся из квадратов независимых положительных случайных величин. Высчитывая F-значение, мы делим одну величину, имеющую распределение хи-квадрат, на другую величину, имеющую распределение хи-квадрат. Каждой из них соответствует своё количество степеней свободы. Получается, что распределение F-статистики будет характеризоваться двумя параметрами - степенями свободы для двух распределений хи-квадрат!

При зависимых переменных, в случае если для высчитывания одной переменной, нам нужны данных остальных - количество этих остальных и будет числом степеней свободы.

Как в примере с монеткой - для того чтобы узнать количество выпадения Орлов нам надо знать количество Решек. Итого 2 зависимых переменных, а значит 1 степень свободы.
![[Pasted image 20240217191257.png]]

**Анализ таблиц сопряженности**

![[Pasted image 20240217193415.png]]

![[Pasted image 20240217194329.png]]
![[Pasted image 20240217194636.png]]
![[Pasted image 20240217195452.png]]
Поправка Йейтса на непрерывность – это процедура, разработанная британским статистиком Франком Йейтсом (Frank Yates) для критерия независимости хи-квадрат при работе с таблицами 2×2. Распределение хи-квадрат непрерывное, однако данные, используемые в критерии хи-квадрат, дискретные, и поправка Йейтса была придумана как раз для того, чтобы исправить это несоответствие [...]

Идея поправки Йейтса состоит в том, что уменьшение значения хи-квадрат приводит к уменьшению вероятности ошибки первого рода (ошибочного отвержения нулевой гипотезы). Однако использование поправки Йейтса одобряется далеко не всеми; некоторые исследователи считают, что она может приводить к слишком сильной коррекции с понижением мощности и повышению вероятности ошибки второго рода (ошибочного неотвержения нулевой гипотезы). Некоторые статистики отвергают поправку Йейтса в принципе, хотя другие находят ее полезной в случае разреженных данных, особенно если хотя бы в одной ячейке ожидаемая величина меньше 5.
![[Pasted image 20240217195623.png]]
![[Pasted image 20240217195859.png]]
![[Pasted image 20240217195942.png]]


Такой график можно создать с помощью функции mosaicplot из базового пакета graphics в R.

```

#воссоздадим таблицу
patients <- rbind(c(18, 7), c(6, 13))
#подпишем строки и столбцы
colnames(patients) <- c("Yes", "No")
rownames(patients) <- c("Placebo", "Aspirin")
#вот график, который нам нужен
mosaicplot(patients, color=T, shade=T, ylab="Thrombosis", xlab="Group")
#а вот так можно в точности воспроизвести рисунок, который мы видели
mosaicplot(patients, color=T, shade=T, ylab="Thrombosis", xlab="Group", cex.axis=1, main="")
```
Подробнее ознакомиться с настройками этой функции можно с помощью справки (?mosaicplot). Об общих настройках базовой графики R, на которых мы сейчас останавливаться не будем, можно почитать в справке к функции par (?par).

Вот что у нас получилось:
![[Pasted image 20240217202128.png]]
Разберемся, как здесь отображены наши данные. Ширина и высота каждого прямоугольника пропорциональны наблюдаемым частотам в соответствующих строках и столбцах. Цвет прямоугольника показывает величину стандартизированного остатка; если она по модулю больше 2, то прямоугольник будет полупрозрачным, если больше 4, то соответствующий прямоугольник будет закрашен

**_Итого:_**

**_- размер прямоугольников  соответствует количеству наблюдений._**

**- цвет прямоугольников - величине значимости отклонения ожидаемых и наблюдаемых частот в этой ячейке.**

**- если значения стандартизированных остатков больше 3х, можно считать, что в этой ячейке зафиксированы значимые отклонения.**

Кстати, давайте сдвинем наше распределение так, чтобы в нашем графике появились закрашенные ячейки.

```

#воссоздадим таблицу
patients2 <- rbind(c(25, 1), c(3, 30))
#подпишем строки и столбцы
colnames(patients2) <- c("Yes", "No")
rownames(patients2) <- c("Placebo", "Aspirin")
#вот наш график
mosaicplot(patients2, color=T, shade=T, ylab="Thrombosis", xlab="Group", cex.axis=1, main="")
```

**Если данных мало, будем использовать точный критерий Фишера!**

![[Pasted image 20240217203412.png]]

![[Pasted image 20240217203805.png]]

![[Pasted image 20240217204025.png]]
![[Pasted image 20240217204118.png]]
