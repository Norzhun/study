Метод Монте-Карло – группа численных методов, основанных на воспроизведении и статистическом анализе большого числа реализаций случайного процесса. Проводится математическое моделирование случайных процессов и параметры их реализации оцениваются статистически. Метод лежит в основе статистического моделирования.
## Вычисление площадей

Применим метод Монте-Карло и к задаче вычисления площади геометрической фигуры на плоскости.

Поместим фигуру в прямоугольник и будем наугад бросать точки в этот прямоугольник. Будем исходить из того, что чем больше площадь фигуры, тем чаще в нее будут попадать точки. Таким образом, при большом числе n точек, наугад выбранных внутри прямоугольника, доля точек, содержащихся в данной фигуре k, приближенно равна отношению площади этой фигуры и площади прямоугольника.

Если площадь прямоугольника равна S0​ и в результате испытаний, из которых при k исходах случайные точки оказались внутри фигуры, то площадь S фигуры будет определяться выражением S=n/k​⋅S0​. Рассмотрим алгоритм решения задачи на конкретных примерах.

**Пример 1.** Рассмотрим фигуру, множество точек которой определяется следующей системой неравенств:
![[Pasted image 20231111235902.png]]

![](https://ucarecdn.com/9fe3fe1e-fd53-4241-a4aa-ac20f19ebe8d/)

Площадь такой фигуры S=1/3​≈ 0.33333 (считается через интеграл).

**Алгоритм Монте-Карло:** площадь искомой фигуры составляет часть квадрата со сторонами 11. Площадь такого квадрата равна 11.

1. Генерируем случайные числа x и y равномерно распределенные на отрезке [0;1][0;1]. Это будут координаты случайной точки в квадрате, в которую заключена фигура, площадь которой требуется найти. Полученная точка может как попасть в исследуемую фигуру, так и не попасть.
2. Проверяем принадлежность точки к исследуемой фигуре. Если попадания нет, т.е. не выполняется неравенство y≤x^2, то переходим к пункту 1 и генерируем координаты новой точки. Если попадание есть, то фиксируем это попадание, то есть увеличиваем на единицу значение счетчика числа попаданий и снова переходим к пункту 1.

![](https://ucarecdn.com/cfc26f84-fdc7-4432-843e-9c819acced83/)

**Примечание.** Заметим, что попадание случайной точки точно на границу фигуры можно отнести как к первому, так и ко второму исходу.

Пункты 1 и 2 следует повторить в цикле достаточно большое количество n раз. От количества повторений напрямую зависит точность результата. После проведения n повторов площадь фигуры найдем по формуле:S=n/k​⋅S0​.

Пример программы на Python:

```python
import random

n = 1000
k = 0
s0 = 1
for _ in range(n):
    x = random.uniform(0, 1)     # случайное число с плавающей точкой от 0 до 1
    y = random.uniform(0, 1)     # случайное число с плавающей точкой от 0 до 1

    if y <= x**2:                # если попадает в нужную область
        k += 1

print((k/n)*s0)
```

Составим таблицу:

|   |   |
|---|---|
|n|S|
|1010|0.60.6|
|100100|0.370.37|
|10001000|0.3370.337|
|1000010000|0.33370.3337|
|100000100000|0.333290.33329|
|10000001000000|0.3335710.333571|
|1000000010000000|0.33328280.3332828|
|100000000100000000|0.333367070.33336707|

**Пример 2.** Рассмотрим фигуру, множество точек которой определяется следующей системой неравенств:
![[Pasted image 20231112000105.png]]

![](https://ucarecdn.com/5f0652cf-0098-4cdd-a47c-de194b3bc4e3/)

Площадь этой фигуры нам заранее известна и равна S=8.38404.

![](https://ucarecdn.com/dbebbc79-a578-4bfa-b5ef-5c3b8816ef67/)

**Алгоритм Монте-Карло:** площадь искомой фигуры составляет часть квадрата со сторонами 44. Площадь такого квадрата равна 1616.

1. Генерируем случайные числа x и y, равномерно распределенные на отрезках [−2;2][−2;2]. Это будут координаты случайных точек в квадрате, в который заключена фигура искомой площади. Полученная точка может как попасть в исследуемую фигуру, так и не не попасть.
2. Проверяем принадлежность точки к исследуемой фигуре. Если попадания нет, не выполняется хотя бы одно из  неравенств y^3−2x^2≤−1 или y+x^3≤3, переходим к пункту 1 и генерируем координаты новой точки. Если попадание есть, фиксируем это попадание, то есть увеличиваем на единицу значение счетчика числа попаданий и снова переходим к пункту 1.

```python
import random

n = 1000
k = 0
s0 = 16
for _ in range(n):
    x = random.uniform(-2, 2)
    y = random.uniform(-2, 2)

    if y**3 - 2*x**2 <= -1 and 2*y + x**3 <= 3:
        k += 1

print((k/n)*s0)
```

Составим таблицу:

|   |   |
|---|---|
|n|S|
|1010|9.69.6|
|100100|8.968.96|
|10001000|8.2248.224|
|1000010000|8.38248.3824|
|100000100000|8.365288.36528|
|10000001000000|8.3833768.383376|
|1000000010000000|8.38415848.3841584|
|100000000100000000|8.384041348.38404134|